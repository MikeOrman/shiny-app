"0","# Construct alteration table for genes that are deleted"
"0","if (length(deleted) > 0){"
"0","  deleted <- as.data.frame(deleted)"
"0","  deleted[,2] <- ""Deletion"""
"0","  for (i in (1:nrow(deleted))) {"
"0","    index1 <- which(met.coloss.del$Hugo_Symbol == deleted[i,1])"
"0","    index2 <- which(primary.coloss.del$Hugo_Symbol == deleted[i,1])"
"0","    index3 <- which(del.enrichment$Hugo_Symbol == deleted[i,1])"
"0","    deleted[i,3] <- met.coloss.del[index1, 2] - primary.coloss.del[index2, 2]"
"0","    deleted[i,4] <- del.enrichment[index3, 9]"
"0","  }"
"0","  #deleted[,4] <- p.adjust(deleted[,4], method = ""fdr"")"
"0","colnames(deleted) <- c(""Hugo Symbol"", ""Alteration"", ""Subtype Alteration Ratio Difference (Met - Primary)"",""pval"")"
"0","}"
"0","# Construct alteration table for genes that are amplified"
"0","if (length(amplified) >0){"
"0","  amplified <- as.data.frame(amplified)"
"0","  amplified[,2] <- ""Amplification"""
"0","  for (i in (1:nrow(amplified))) {"
"0","    index1 <- which(met.coloss.amp$`Hugo_Symbol` == amplified[i,1])"
"0","    index2 <- which(primary.coloss.amp$Hugo_Symbol == amplified[i,1])"
"0","    index3 <- which(amp.enrichment$Hugo_Symbol == amplified[i,1])"
"0","    amplified[i,3] <- met.coloss.amp[index1, 2] - primary.coloss.amp[index2, 2]"
"0","    amplified[i,4] <- amp.enrichment[index3, 9]"
"0","  }"
"0","  #amplified[,4] <- p.adjust(amplified[,4], method = ""fdr"")"
"0","colnames(amplified) <- c(""Hugo Symbol"", ""Alteration"", ""Subtype Alteration Ratio Difference (Met - Primary)"",""pval"")"
"0","}"
"0","# Construct alteration table for genes that are deleted and amplified. Report the average change in alteration and the combined p-val."
"0","if (length(both) >0){"
"0","  both <- as.data.frame(both)"
"0","  both[,2] <- ""Amplification & Deletion"""
"0","  for (i in (1:nrow(both))) {"
"0","    index1a <- which(met.coloss.del$`Hugo_Symbol` == both[i,1])"
"0","    index1b <- which(met.coloss.amp$`Hugo_Symbol` == both[i,1])"
"0","    index2a <- which(primary.coloss.del$`Hugo_Symbol` == both[i,1])"
"0","    index2b <- which(primary.coloss.amp$Hugo_Symbol == both[i,1])"
"0","    index3a <- which(del.enrichment$Hugo_Symbol == deleted[i,1])"
"0","    index3b <- which(amp.enrichment$Hugo_Symbol == both[i,1])"
"0","    both[i,3] <- (((met.coloss.del[index1a, 2] - primary.coloss.del[index2a, 2]) + "
"0","                     (met.coloss.amp[index1b, 2] - primary.coloss.amp[index2b, 2])) / 2)"
"0","    both[i,4] <- sumlog(c(del.enrichment[index3a, 9], amp.enrichment[index3b, 9]))$p"
"0","  }"
"0","  #both[,4] <- p.adjust(both[,4], method = ""fdr"")"
"0","colnames(both) <- c(""Hugo Symbol"", ""Alteration"", ""Average Subtype Alteration Ratio Difference (Met - Primary)"",""combined pval"")"
"0","}"
"0","# Combine alteration tables"
"0","if (length(both) == 0){"
"0","  if ((length(deleted) > 0) & (length(amplified) > 0)){"
"0","  summary <- rbind(deleted, amplified)"
"0","}"
"0","  if ((length(deleted) > 0) & (length(amplified) == 0)){"
"0","  summary <- (deleted)"
"0","}"
"0","  if ((length(deleted) == 0) & (length(amplified) > 0)){"
"0","  summary <- (amplified)"
"0","  }"
"0","}"
"0","if (length(both) > 0){"
"0","    if ((length(deleted) > 0) & (length(amplified) > 0)){"
"0","  summary <- rbind(deleted, amplified)"
"0","  summary <- rbind(summary, both)"
"0","}"
"0","  if ((length(deleted) > 0) & (length(amplified) == 0)){"
"0","  summary <- (deleted)"
"0","  summary <- rbind(summary, both)"
"0",""
"0","}"
"0","  if ((length(deleted) == 0) & (length(amplified) > 0)){"
"0","  summary <- (amplified)"
"0","  summary <- rbind(summary, both)"
"0","  }"
"0","}"
"0","library(DT)"
"0","datatable(summary)"
