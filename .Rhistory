View(del.enrichment)
subset <- met.coloss
dataset <- primary.coloss
#Calc exclusive copy number loss genes
subset.loss = lossRank(subset)[,c(1,3,4,5)]
# Primary
primary.coloss <- subtype_subset(subtype_subset(primary, c("MAP3K7", "loss")), c("CHD1", "loss"))
primary.WT <- subtype_subset(subtype_subset(primary, c("MAP3K7", "WT/gain")), c("CHD1", "WT/gain"))
# Metastatic
met.coloss <- subtype_subset(subtype_subset(met, c("MAP3K7", "loss")), c("CHD1", "loss"))
met.WT <- subtype_subset(subtype_subset(met, c("MAP3K7", "WT/gain")), c("CHD1", "WT/gain"))
genes <- intersect(del.C1.genes, del.C2.genes)
# Filter primary subtype patients
primary.coloss.index <- c()
for (i in 1:nrow(primary.coloss)){
if (sum(primary.coloss$Hugo_Symbol[i] == genes) == 1)
{primary.coloss.index[i] = TRUE}
if (sum(primary.coloss$Hugo_Symbol[i] == genes) == 0)
{primary.coloss.index[i] = FALSE}
}
primary.coloss <- primary.coloss[primary.coloss.index,]
# Filter primary WT patients
primary.WT.index <- c()
for (i in 1:nrow(primary.WT)){
if (sum(primary.WT$Hugo_Symbol[i] == genes) == 1)
{primary.WT.index[i] = TRUE}
if (sum(primary.WT$Hugo_Symbol[i] == genes) == 0)
{primary.WT.index[i] = FALSE}
}
primary.WT <- primary.WT[primary.WT.index,]
# Filter metastatic subtype patients
met.coloss.index <- c()
for (i in 1:nrow(met.coloss)){
if (sum(met.coloss$Hugo_Symbol[i] == genes) == 1)
{met.coloss.index[i] = TRUE}
if (sum(met.coloss$Hugo_Symbol[i] == genes) == 0)
{met.coloss.index[i] = FALSE}
}
met.coloss <- met.coloss[met.coloss.index,]
# Filter metastatic WT patients
met.WT.index <- c()
for (i in 1:nrow(met.WT)){
if (sum(met.WT$Hugo_Symbol[i] == genes) == 1)
{met.WT.index[i] = TRUE}
if (sum(met.WT$Hugo_Symbol[i] == genes) == 0)
{met.WT.index[i] = FALSE}
}
met.WT <- met.WT[met.WT.index,]
subset <- met.coloss
dataset <- primary.coloss
#Calc exclusive copy number loss genes
subset.loss = lossRank(subset)[,c(1,3,4,5)]
colnames(subset.loss) <- c("Hugo_Symbol", "Subset loss", "Subset unaltered", "Subset loss ratio")
dataset.loss = lossRank(dataset)[,c(1,3,4,5)]
colnames(dataset.loss) <- c("Hugo_Symbol", "Dataset loss", "Dataset unaltered", "Dataset loss ratio")
both.loss = merge.data.frame(subset.loss, dataset.loss)
i = 1
normalized.loss = both.loss$`Subset loss ratio`[i] / both.loss$`Dataset loss ratio`[i]
matrix = matrix(as.numeric(both.loss[i, c(2, 5, 3, 6)]), ncol = 2)
fishers <- fisher.test(matrix)
View(fishers)
View(fishers)
library(ggplot2)
library(ggrepel)
# Order hits by increasing alteration rate in metastatic subtype
summary <- summary[order(summary$`Subtype Alteration Ratio Difference (Met - Primary)`, decreasing = TRUE),]
summary[,5] <- c(1:nrow(summary))
colnames(summary)[5] <- "Gene Rank"
# Add annotations
annotations <- Bands(summary$`Hugo Symbol`)
summary <- cbind(summary, annotations$Band)
colnames(summary)[6] <- "Cytogenetic Band"
# Report summary
datatable(summary)
# Plot ranked summary data
ggplot(data = summary, mapping = aes(`Gene Rank`, `Subtype Alteration Ratio Difference (Met - Primary)`, label = `Hugo Symbol`)) + geom_point() + ggtitle("Alteration Frequency Difference: Met - Primary") + ylim(-.4,.4) + geom_text_repel(data = subset(summary, `Gene Rank` <= 2 | `Gene Rank` >= 3044), nudge_x = 0, nudge_y = -.165)
save.image("~/Github/Projects/shiny app/Jim's method.RData")
seq(0,.05, by = 0.005)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
deletions <- merge.data.frame(primary.WT.del, primary.coloss.del)
deletions <- merge.data.frame(deletions, met.WT.del)
deletions <- merge.data.frame(deletions, met.coloss.del)
amplifications <- merge.data.frame(primary.WT.amp, primary.coloss.amp)
amplifications <- merge.data.frame(amplifications, met.WT.amp)
amplifications <- merge.data.frame(amplifications, met.coloss.amp)
index.del.C1 <- (deletions$`Deletion rate: Primary coloss patients` > deletions$`Deletion rate: Primary WT patients`)
del.C1.genes <- deletions$Hugo_Symbol[index.del.C1]
index.amp.C1 <- (amplifications$`Amplification rate: Primary coloss patients` > amplifications$`Amplification rate: Primary WT patients`)
amp.C1.genes <- amplifications$Hugo_Symbol[index.amp.C1]
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(0,.05, by = 0.005)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[i,1] <- i
C2.table[i,2] <- genes.captured
}
length(amp.genes)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(0,.05, by = 0.005)){
print(i)
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[i,1] <- i
C2.table[i,2] <- genes.captured
}
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.005,.05, by = 0.005)){
print(i)
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[i,1] <- i
C2.table[i,2] <- genes.captured
}
View(C2.table)
i = 0.005
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[i,1] <- i
View(C2.table)
nrow(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.005,.05, by = 0.005)){
print(i)
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table),1] <- i
C2.table[nrow(C2.table),2] <- genes.captured
}
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.005,.05, by = 0.005)){
print(i)
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,1] <- i
C2.table[nrow(C2.table)+1,2] <- genes.captured
}
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.005,.1, by = 0.005)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
library(DT)
datatable(C2.table)
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1,1e-5, by = .05)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1,1e-5, by = -.05)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, .00001, by = -.005)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, .00001, by = -.0001)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, .00001, by = -.001)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, .00001, by = -.01)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, .000001, by = -.01)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.001, .1, by = .005)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.001, .1, length.out = 10)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.0001, .1, length.out = 10)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, 1e-5, length.out = 20)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.2, 1e-5, length.out = 30)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, 1e-5, length.out = 30)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, 1e-5, length.out = 50)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, 1e-5, length.out = 100)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, 1e-5, length.out = 10)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaning")
library(DT)
datatable(C2.table)
ggplot(data = C2.table, mapping = aes(C2.table$`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining)) + geom_dotplot()
ggplot(data = C2.table, mapping = aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining)) + geom_dotplot()
ggplot(data = C2.table aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining)) + geom_dotplot()
ggplot(data = C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining)) + geom_dotplot()
ggplot(C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_dotplot()
ggplot(C2.table, mapping = aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_dotplot()
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.1, 1e-5, length.out = 10)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaining")
library(DT)
datatable(C2.table)
ggplot(C2.table, mapping = aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_dotplot()
ggplot(data = C2.table, mapping = aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_dotplot()
ggplot(data = C2.table, mapping = aes(x= `WT Alteration Ratio Difference: |Met - Primary|`, y=`Genes Remaining`)) + geom_dotplot()
ggplot(data = C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_point()
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.2, 1e-5, length.out = 20)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaining")
library(DT)
ggplot(data = C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_point()
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.2, 1e-5, length.out = 20)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaining")
library(DT)
ggplot(data = C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_point() + ggtitle("Genes captured over criterion 2 cutoffs")
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.2, 1e-5, length.out = 20)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaining")
library(DT)
ggplot(data = C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_point() + ggtitle("Genes captured over constraint 2 cutoffs") + xlab("Constraint 2 Cutoff")
# Test genes captured at different effect sizes and report as table
C2.table <- data.frame()
for (i in seq(.2, 1e-5, length.out = 20)){
index.del.C2 <- (abs(deletions$`Deletion rate: Metastatic WT patients`-deletions$`Deletion rate: Primary WT patients`) <= i)
del.C2.genes <- deletions$Hugo_Symbol[index.del.C2]
index.amp.C2 <- ((abs(amplifications$`Amplification rate: Metastatic WT patients`- amplifications$`Amplification rate: Primary WT patients`)) <= i)
amp.C2.genes <- amplifications$Hugo_Symbol[index.amp.C2]
del.genes <- intersect(del.C1.genes, del.C2.genes)
amp.genes <- intersect(amp.C1.genes, amp.C2.genes)
genes.captured <- length(del.genes) + length(amp.genes)
C2.table[nrow(C2.table)+1,c(1,2)] <- c(i, genes.captured)
}
colnames(C2.table) <- c("WT Alteration Ratio Difference: |Met - Primary|", "Genes Remaining")
library(DT)
ggplot(data = C2.table, aes(`WT Alteration Ratio Difference: |Met - Primary|`, `Genes Remaining`)) + geom_point() + xlab("Constraint 2 Cutoff")
